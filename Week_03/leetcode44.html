<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
<script>
  /**
 * @param {string} s
 * @param {string} p
 * @return {boolean}
 */
var isMatch = function(s, p) {
  if (s === '' && p === '') return true
  if (p === '') return false

  // 若p第一个字符就为*，则不必要从s的第一个字符开始匹配，否则，必须从s[0]开始
  // 若p最后一个字符为*，则最后一段不必从最后向前匹配，否则，必须从s[s.length -1]开始向前
  let hasFirstStar = p[0] === '*'
  let hasLastStar = p[p.length - 1] === '*'
  // 以*为分割，将p分割为数段
  let pList = p.split('*')
  pList = pList.filter(item => item !== '')
  // if (hasFirstStar) pList.shift()
  // if (hasLastStar) pList.pop()
  
  const len = pList.length
  if (len === 0) return true
  const resultList = new Array(len).fill(0) // 作为各段是否匹配上的结果数组
  let i = 0
  let j = 0
  let k = 0

  while ( i < s.length && j < len) {
      const itemLen = pList[j].length
      if (s[i] === pList[j][k] || pList[j][k] === '?') {
          i += 1
          k += 1
          if (k === itemLen) {
            resultList[j] = [i - itemLen, itemLen]
            j += 1
            k = 0
          }
      } else {
          if (k > 0) {
            k = 0
          }
          i += 1
      }
  }

  if (resultList.indexOf(0) !== -1) return false
  if (!hasFirstStar && resultList[0][0] !== 0) return false
  if (!hasLastStar) {
    if (pList[len - 1] !== s.slice(s.length - pList[len -1].length)) return false
    // if (i !== s.length) return false
  }
  return true
};

console.log(isMatch('abefcdgiescdfimde', 'ab*cd?i*de'))
console.log(isMatch('adceb', '*a*b'))
console.log(isMatch('acdcb', 'a*c?b'))
console.log(isMatch('aaaa', '***a'))
console.log(isMatch('aa', 'a'))

</script>
</body>
</html>

pList[len - 1] === s.slice(s.length - pList[len -1].length - 1)
